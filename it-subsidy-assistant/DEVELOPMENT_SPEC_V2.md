# IT補助金アシスタント開発仕様書 V2

## プロジェクト概要
IT補助金アシスタントは、中小企業がIT導入補助金をはじめとする各種補助金申請を効率的に行えるよう支援するWebアプリケーションです。

## 最新の実装状況（2024年1月）

### 完成している主要機能

1. **補助金診断フロー**
   - 6つの基礎質問による適性診断
   - AIを活用した最適な補助金マッチング
   - 4種類の補助金に対応（IT導入、ものづくり、持続化、事業再構築）

2. **申請者プロフィール管理**
   - 5ステップの詳細なプロフィール入力フォーム
   - 会社情報、代表者情報、連絡先、事業内容、財務情報の管理
   - ローカルストレージでの自動保存

3. **AI文書生成機能（大幅改善済み）**
   - 最小限の質問（3-5問）から申請書類を自動生成
   - 具体的な数値目標と削減効果を含む高品質な文書
   - 実際の採択事例レベルの文体と構成
   - 各補助金タイプに最適化されたテンプレート

4. **文書編集・ダウンロード機能**
   - Web上での直接編集（インライン編集）
   - 編集内容の自動保存
   - テキストファイル形式でのダウンロード
   - 編集済み文書の視覚的識別

5. **マイページ機能**
   - 申請進捗の管理
   - 過去の申請履歴
   - 保存した文書の一覧

## 技術スタック

### フロントエンド
- React 18 + TypeScript
- Vite（ビルドツール）
- React Router（ルーティング）
- CSS-in-JS（スタイリング）
- ローカルストレージ（データ永続化）

### バックエンド
- Node.js + Express
- TypeScript
- OpenAI API（AI文書生成）
- CORS対応
- RESTful API設計

## AI文書生成の特徴（V2改善版）

### 数値表現の具体化
- 工数削減：「作業時間を月間150時間から45時間へ70%削減」
- 金額換算：「年間1,260時間の削減により、人件費252万円相当」
- ROI明記：「投資額300万円、年間効果900万円、ROI 300%」

### 補助金別の最適化
1. **IT導入補助金**
   - 受注処理、在庫管理、請求書発行の自動化による工数削減
   - 投資回収期間4-6ヶ月を目標

2. **ものづくり補助金**
   - 技術的課題と革新的解決方法を3つ提示
   - 不良率改善、検査時間短縮、稼働率向上の数値化

3. **持続化補助金**
   - 販売チャネル分析（店頭、EC、SNS）
   - 客単価向上と新規顧客獲得の具体的施策

4. **事業再構築補助金**
   - 危機的状況の数値化（売上60%減等）
   - V字回復シナリオ（3年で300%成長）

## セキュリティ対策

### 実施済み対策
- APIキーのハードコード削除
- 環境変数での機密情報管理
- .gitignoreでの適切なファイル除外
- CORS設定によるアクセス制御
- 入力値検証とサニタイズ

### 推奨事項
- 本番環境ではAPIキーをバックエンドのみで管理
- HTTPS通信の強制
- レート制限の実装
- 定期的なセキュリティ監査

## インストールと起動方法

### 前提条件
- Node.js 18以上
- npm または yarn
- OpenAI APIキー（AI機能を使用する場合）

### セットアップ手順

1. **リポジトリのクローン**
```bash
git clone [repository-url]
cd it-subsidy-assistant
```

2. **環境変数の設定**

バックエンド（`backend/.env`）:
```
PORT=3001
OPENAI_API_KEY=your-openai-api-key
NODE_ENV=development
```

3. **依存関係のインストール**
```bash
# バックエンド
cd backend
npm install

# フロントエンド
cd ../frontend
npm install
```

4. **アプリケーションの起動**
```bash
# バックエンド（別ターミナル）
cd backend
npm run dev

# フロントエンド（別ターミナル）
cd frontend
npm run dev
```

5. **アクセス**
- フロントエンド: http://localhost:5173
- バックエンドAPI: http://localhost:3001

## 主要なエンドポイント

### フロントエンドルート
- `/` - トップページ（補助金診断開始）
- `/subsidy-results` - 診断結果
- `/ai-document/:subsidyType` - AI文書生成
- `/completion/:subsidyType` - 完了ページ（編集・ダウンロード）
- `/mypage` - マイページ

### バックエンドAPI
- `POST /v1/ai-document/generate` - AI文書生成
- `GET /v1/subsidies` - 補助金一覧
- `POST /v1/diagnosis` - 診断結果保存

## 今後の開発予定

### Phase 1（短期）
- [ ] Word/PDF形式でのエクスポート機能
- [ ] 複数文書の一括ダウンロード
- [ ] 申請書類のテンプレート管理
- [ ] プロフィール情報のインポート/エクスポート

### Phase 2（中期）
- [ ] ユーザー認証機能（Supabase連携）
- [ ] クラウドストレージ連携
- [ ] 申請進捗のリアルタイム共有
- [ ] 申請書類の自動チェック機能

### Phase 3（長期）
- [ ] 専門家による申請サポート機能
- [ ] 補助金情報の自動更新
- [ ] 申請成功事例の共有
- [ ] 多言語対応

## 開発上の注意事項

1. **APIキー管理**
   - フロントエンドにAPIキーをハードコードしない
   - 環境変数を使用して管理
   - 本番環境ではバックエンドプロキシを使用

2. **データ永続化**
   - 現在はローカルストレージを使用
   - 将来的にはデータベース（PostgreSQL/Supabase）への移行を予定

3. **エラーハンドリング**
   - API呼び出しは必ずtry-catchで囲む
   - ユーザーフレンドリーなエラーメッセージを表示
   - エラーログの適切な記録

4. **パフォーマンス**
   - 大きなテキストデータは適切に分割
   - 画像は遅延読み込みを使用
   - 不要な再レンダリングを防ぐ

## 貢献方法

1. Issueを作成して機能提案やバグ報告
2. フォークしてプルリクエストを送信
3. コードレビューへの参加
4. ドキュメントの改善

## ライセンス
MIT License

## 連絡先
プロジェクトに関する質問は、GitHubのIssueでお願いします。